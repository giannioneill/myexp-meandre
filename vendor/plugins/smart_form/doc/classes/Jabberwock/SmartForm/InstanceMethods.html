<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: Jabberwock::SmartForm::InstanceMethods</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">Jabberwock::SmartForm::InstanceMethods</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/jabberwock/smart_form/instance_methods_rb.html">
                lib/jabberwock/smart_form/instance_methods.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">
    <div id="diagram">
      <map id="map" name="map">
  <area shape="rect" coords="63,5,159,53"      href="../../StandardError.html" alt="StandardError" />
  <area shape="rect" coords="53,168,187,216"      href="../UnknownColumnType.html" alt="UnknownColumnType" />
  <area shape="rect" coords="183,5,369,53"      href="../../ActiveRecord/ActiveRecordError.html" alt="ActiveRecord::ActiveRecordError" />
  <area shape="rect" coords="211,168,323,216"      href="../ColumnNotFound.html" alt="ColumnNotFound" />
  <area shape="rect" coords="473,157,567,204"      href="ClassMethods.html" alt="ClassMethods" />
  <area shape="rect" coords="360,157,463,204"      href="InstanceMethods.html" alt="InstanceMethods" />
  <area shape="rect" coords="336,124,577,215"      href="../SmartForm.html" alt="SmartForm" />
  <area shape="rect" coords="16,91,588,227"      href="../../Jabberwock.html" alt="Jabberwock" />
</map>
<img src="../../../dot/f_1.png" usemap="#map" border="0" alt="dot/f_1.png">
    </div>



   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000003">smart_form_for</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000003" class="method-detail">
        <a name="M000003"></a>

        <div class="method-heading">
          <a href="#M000003" class="method-signature">
          <span class="method-name">smart_form_for</span><span class="method-args">(obj, options = {})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Generates form fields for a model - including it&#8216;s content columns,
and all association reflections. The form fields are encapsulated in an
HTML definition list.
</p>
<p>
For an example style-sheet, you may use:
</p>
<pre>
  &lt;tt&gt;ruby ./script/generate SmartFormStyles&lt;/tt&gt;
</pre>
<h1>Note:</h1>
<p>
<tt><a href="InstanceMethods.html#M000003">smart_form_for</a></tt>
generates only the <tt>form</tt> fields and not the starting/ending
<tt>form</tt> tags.
</p>
<h2>Usage:</h2>
<p>
<a href="InstanceMethods.html#M000003">smart_form_for</a>(symbol, options)
</p>
<h2>Examples:</h2>
<pre>
  &lt;% form_for &quot;/people&quot;, :method =&gt; :post do %&gt;
    &lt;%= smart_form_for :person %&gt;
  &lt;% end %&gt;
</pre>
<h2>Other Examples:</h2>
<pre>
  &lt;%= smart_form_for :person, :exclude =&gt; 'created_at' %&gt;
  &lt;%= smart_form_for :person, :exclude =&gt; ['created_at', 'updated_at'], :class =&gt; 'my_list', :style =&gt; 'border:1px solid white;', :id =&gt; 'my_list' %&gt;
</pre>
<h2>Options</h2>
<ul>
<li><tt>symbol</tt> &#8212; A symbol of a model instance variable for which the
form fields will be generated.

</li>
<li><tt>:object</tt> &#8212; Takes an instance variable (ie; used to load form
defaults for editing)

</li>
<li><tt>:habtm_select_values</tt>&#8212; A hash in which each key is a habtm
reflection name and the value is the foreign column to use for

<pre>
                                the select/multiple option values. By default, the first column of type +text+ or +varchar+ is used.
</pre>
</li>
<li><tt>:exclude</tt> &#8212; A <tt>String</tt>, or an <tt>Array</tt> of column
names (or associatin reflection(s)) to exclude from the form.

</li>
<li><tt>:include</tt> &#8212; A <tt>String</tt>, or an <tt>Array</tt> of column
names which would not otherwise be included in the model&#8216;s
<tt>content_columns</tt>.

<pre>
                                For example, an 'orders' table  might contain a 'transaction_id' column which refers to an Authorize.NET
                                transaction ID, and not a foreign key to a 'transactions' table. Because this column ends with &quot;_id&quot;, it
                                will not be in the models content columns. Use this option to display form fields for these types of columns.
</pre>
</li>
<li><tt>:class</tt> &#8212; The <tt>class</tt> attribute for the <tt>DL</tt>
element (defaults to &quot;<tt>smart_form</tt>&quot;).

</li>
<li><tt>:text_field</tt> &#8212; HTML options for text <tt>input</tt> fields.

</li>
<li><tt>:number_text_field</tt> &#8212; HTML options for text <tt>input</tt>
fields that deal with numbers (ie: decimal, float, integer)

</li>
<li><tt>:text_area</tt> &#8212; HTML options for <tt>textarea</tt> elements

</li>
<li><tt>:select</tt> &#8212; Options for <tt>select</tt> (default:
:include_blank =&gt; true). Also contains an :@sf_html hash of HTML options
to pass.

</li>
<li><tt>:date_select</tt> &#8212; HTML options for <tt>date_select</tt>

</li>
<li><tt>:datetime_select</tt> &#8212; HTML options for <tt>datetime_select</tt>

</li>
<li><tt>:time_select</tt> &#8212; HTML options for <tt>time_select</tt>

</li>
<li><tt>:mselect</tt> &#8212; HTML options for +select
multiple=&quot;multiple&quot;+ boxes

</li>
<li><tt>:mselect_footnote</tt> &#8212; A footnote which appears below
select/multiples (default: &quot;(crtl+click to select multiple)&quot;)

</li>
<li><tt>:left_width</tt> &#8212; The width of the left column in pixels. If
specified, this setting will override the style-sheet

</li>
<li><tt>:right_width</tt> &#8212; The width of the right column in pixels. If
specified, this setting will override the style-sheet

</li>
</ul>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000003-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000003-source">
<pre>
    <span class="ruby-comment cmt"># File lib/jabberwock/smart_form/instance_methods.rb, line 47</span>
47:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">smart_form_for</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">options</span> = {})
48:         <span class="ruby-ivar">@sf_options</span>   = <span class="ruby-constant">DEFAULT_FORM_OPTIONS</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>)
49:         <span class="ruby-ivar">@sf_options</span>[<span class="ruby-identifier">:exclude</span>] = [<span class="ruby-ivar">@sf_options</span>[<span class="ruby-identifier">:exclude</span>]] <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@sf_options</span>[<span class="ruby-identifier">:exclude</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
50:         <span class="ruby-ivar">@sf_exclude</span>   = <span class="ruby-ivar">@sf_options</span>[<span class="ruby-identifier">:exclude</span>] <span class="ruby-operator">+</span> <span class="ruby-constant">DEFAULT_FORM_OPTIONS</span>[<span class="ruby-identifier">:exclude</span>] <span class="ruby-comment cmt"># always exclude the default excludes, by default :)</span>
51:         <span class="ruby-ivar">@sf_options</span>[<span class="ruby-identifier">:include</span>] = [<span class="ruby-ivar">@sf_options</span>[<span class="ruby-identifier">:include</span>]] <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@sf_options</span>[<span class="ruby-identifier">:include</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
52:         <span class="ruby-ivar">@sf_include</span>   = <span class="ruby-ivar">@sf_options</span>[<span class="ruby-identifier">:include</span>]
53:         <span class="ruby-ivar">@left_style</span>   = (<span class="ruby-ivar">@sf_options</span>[<span class="ruby-identifier">:left_width</span>].<span class="ruby-identifier">to_i</span>  <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot; style=\&quot;width: #{options[:left_width]}px !Important;\&quot;&quot;</span>)
54:         <span class="ruby-ivar">@right_style</span>  = (<span class="ruby-ivar">@sf_options</span>[<span class="ruby-identifier">:right_width</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-value str">&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot; style=\&quot;width: #{options[:right_width]}px !Important;\&quot;&quot;</span>)
55: 
56:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Symbol</span>)
57:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;The first argument to smart_form must be a symbol&quot;</span>
58:         <span class="ruby-keyword kw">end</span>
59: 
60:         <span class="ruby-ivar">@ar_object</span> = <span class="ruby-identifier">get_class</span>(<span class="ruby-identifier">obj</span>)    
61: 
62:         <span class="ruby-ivar">@sf_html</span> = <span class="ruby-value str">&quot;&quot;</span> 
63: 
64:         <span class="ruby-comment cmt"># Handle all content columns of model:</span>
65:         <span class="ruby-ivar">@ar_object</span>.<span class="ruby-identifier">content_columns</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">col</span><span class="ruby-operator">|</span>
66:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@sf_exclude</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">col</span>.<span class="ruby-identifier">name</span>) <span class="ruby-comment cmt"># ignore columns specified in @sf_options[:exclude]</span>
67:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">col</span>.<span class="ruby-identifier">type</span><span class="ruby-operator">==</span><span class="ruby-identifier">:binary</span> <span class="ruby-comment cmt"># ignoring binary columns</span>
68:           <span class="ruby-identifier">row_for_column</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">col</span>)
69:         <span class="ruby-keyword kw">end</span>
70: 
71:         <span class="ruby-comment cmt"># any column names specfied in @sf_options[:include]? if so, we'll add those to the form: </span>
72:         <span class="ruby-ivar">@sf_include</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
73:           <span class="ruby-comment cmt"># make sure the column exists in the table:</span>
74:           <span class="ruby-identifier">column</span> = <span class="ruby-ivar">@ar_object</span>.<span class="ruby-identifier">columns</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">name</span><span class="ruby-operator">==</span><span class="ruby-identifier">v</span>}
75:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ColumnNotFound</span>, <span class="ruby-node">&quot;The column `#{v}' specified in #{v} was not found in table `#{@ar_object.table_name}'&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">column</span>
76:           <span class="ruby-ivar">@sf_html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;&lt;dl class=\&quot;#{@sf_options[:class]}\&quot;&gt;\n&quot;</span>
77:           <span class="ruby-ivar">@sf_html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;  &lt;dt#{@left_style}&gt;&lt;label for=\&quot;#{v}\&quot;&gt;#{v.name.gsub('_',' ').camelize}:&lt;/label&gt;&lt;/dt&gt;\n&quot;</span>
78:           <span class="ruby-ivar">@sf_html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;  &lt;dd#{@right_style}&gt;&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">text_field</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">v</span>, <span class="ruby-identifier">:size</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@sf_options</span>[<span class="ruby-identifier">:mselect_size</span>]) <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;&lt;/dd&gt;\n&quot;</span>
79:           <span class="ruby-ivar">@sf_html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&lt;/dl&gt;\n&quot;</span>
80:         <span class="ruby-keyword kw">end</span>
81: 
82:         <span class="ruby-comment cmt"># Handle the model's reflection associations, if any:</span>
83:         <span class="ruby-ivar">@ar_object</span>.<span class="ruby-identifier">reflections</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">vhash</span><span class="ruby-operator">|</span>
84:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@sf_exclude</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">vhash</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>) <span class="ruby-comment cmt"># skip any reflection in @sf_exclude]</span>
85:           <span class="ruby-identifier">row_for_reflection</span>(<span class="ruby-identifier">obj</span>, <span class="ruby-identifier">vhash</span>, <span class="ruby-identifier">options</span>)
86:         <span class="ruby-keyword kw">end</span> <span class="ruby-comment cmt"># ar_boject.reflections.each</span>
87: 
88:         <span class="ruby-ivar">@sf_html</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&lt;!-- break --&gt;&lt;div class=\&quot;sf_break\&quot;&gt;&lt;/div&gt;\n&quot;</span>
89:         <span class="ruby-ivar">@sf_html</span>
90:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>